RewriteEngine On

# Redirect root to he-opas.html (landing page)
RewriteRule ^$ he-opas.html [QSA,L]

# Allow direct access to HTML files
RewriteCond %{REQUEST_URI} \.(html)$
RewriteRule ^(.*)$ $1 [L]

# Redirect all other requests to app.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ app.php [QSA,L]

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
</IfModule>

# Disable directory browsing
Options -Indexes

# Hide sensitive files
<Files ~ "\.(log|env|ini)$">
    Order allow,deny
    Deny from all
</Files>

# Allow access to HTML and PHP files
<Files ~ "\.(html|php)$">
    Order allow,deny
    Allow from all
</Files>
<Files ~ "\.(log|env|ini)$">
    Order allow,deny
    Deny from all
</Files>

# Allow access to HTML template
<Files "he-opas.html">
    Order allow,deny
    Allow from all
</Files>
